# 附录：坐标表示

高级标点工具箱支持直角坐标系与极（柱）坐标系，二者的坐标与方向角定义均与 FF14 解析插件一致。

故使用本工具前需要先了解 FF14 中的坐标系定义及触发器中的相关数学函数。

请阅读 [坐标系与角度](./Triggernometry%20触发器写作指南/坐标系与角度.md) 查看相关的定义。

---

## 表示单个坐标

你可以任意使用直角坐标系或极（柱）坐标系表示坐标。

如下表，位于 `(10, 10√3, 0)` 处的 A 点可以用以下两种方式表示。

|     |直角坐标系|极（柱）坐标系|
|:---:|:---:|:---:|
|**格式**|`x, y, z`|`polar r, θ, z`|
|**图示**|<img src="https://github.com/user-attachments/assets/c80126dc-64c1-49a8-8e46-609fa931b449" height="300">|<img src="https://github.com/user-attachments/assets/17d5a528-c174-4502-b5e0-9f7fc77f1391" height="300">|
|**参数**|`A: 10, 10√3, 0`|`A: polar 20, 30°, 0` 或 <br /> `A: polar 20, π/6, 0`|

> [!TIP]
> 
> z = 0 均可省略，如 `A: 10, 10√3`。
>
> 如果你无法理解此表，或有任何疑问，请务必阅读前面的链接 “坐标系与角度” 。

此外你应该会注意到，坐标中可以直接插入 `π` `°` `√` 等数学符号。

这也是高级标点工具箱的特性，允许你在参数部分直接输入数学公式，并调用触发器中的任何数学函数。

[坐标系与角度](./Triggernometry%20触发器写作指南/坐标系与角度.md) 一文也详细介绍了触发器中所有几何函数，对标点时计算角度有很大帮助。

---

## 表示复合坐标

触发器查询实体可以直接获取一串形如 `x, y, z` 的坐标字符串，如果要手动将这样的两组字符串形式的坐标相加减则比较麻烦。

此外，有时会需要叠加两个坐标，比如想表达 `A` 点的坐标位于正东 10 m 开始，向南偏东 22.5° 偏移 3 m，我们希望避免手动计算三角函数与矩阵乘法。

所以在此提供四个运算符关键词：
| 关键词 | 解释 |
| :---: | :---: |
| ... `plus` x, y(, z) | ... 加上坐标 x, y(, z) |
| ... `minus` x, y(, z) | ... 减去坐标 x, y(, z) |
| ... `polar` r, θ(, z) | ... 加上极坐标 r, θ(, z) |
| ... `minuspolar` r, θ(, z) | ... 减去极坐标 r, θ(, z) |

```javascript
// 上方的例子：
A: 10, 0, 0 polar 3, 22.5°

// 这是一个复杂的例子（实际不会用到这么多坐标的复合）：
B: x, y, z plus x2, y2 minus x3, y3, z3 polar r1, θ1 minuspolar r2, θ2, z2
```

> [!TIP]
> 前文单独用于表示极坐标的 `polar r, θ, z` 实际上就相当于 `0, 0, 0 polar r, θ, z`。

---

## 插入表达式

坐标参数与其它数值类参数在解析时稍有不同：

其它数值类参数会直接将 `name: value` 在冒号后的部分作为表达式解析，但坐标则会将 value 按照**「有效的」**逗号拆分成 2-3 部分并单独解析。

如前文所述，你可以放心使用任何触发器内部的数学常数和函数，而无需在每个表达式外侧套上 `${numeric:...}` 使之预处理为数值。

即便你使用了 `round(${x}, 1)` 这样包含逗号的多参数函数，也不会影响逗号的拆分逻辑，程序只会将不包裹在括号内的逗号视为有效分隔符。
